@font-face {
  font-family: 'Futura';
  src: url('../fonts/FuturaPT-Demi.ttf') format('truetype');
  font-style: normal;
}
.container-with-buttons {
  display: flex;
  flex-direction: column; /* кнопки в колонку */
  gap: 8px;               /* расстояние между ними */
}

.mw {
  font-family: 'Futura';
  src: url('../fonts/FuturaPT-Demi.ttf') format('truetype');
  font-style: normal;
  font-size: 30px;
}
:root{
  --bg:#0e0e10; --sidebar:#17171a; --list:#1d1d20; --chat:#121214; --divider:#2a2a2f;
  --me:#3f424a; --other:#2a2c33; --text:#f0f0f2; --muted:#9da0a6;
  --accent:#3a3a3f; --accent-2:#4a4a4f;
  --radius-xl:18px; --radius-lg:14px; --radius-md:10px;
  --shadow:0 8px 22px rgba(0,0,0,.36);
  --own-accent: linear-gradient(135deg,#3f424a,#50545c);
  --composer-h:64px; --sidebar-w:84px; --list-min:220px; --list-max:300px;
}

/* reset & layout */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family:"Segoe UI", Roboto, system-ui, -apple-system, Arial, sans-serif;
  display:grid; grid-template-columns:var(--sidebar-w) 1fr minmax(var(--list-min), var(--list-max));
  height:100vh; min-width:0; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}

/* =================== SIDEBAR (left) =================== */
.sidebar{ background:var(--sidebar); display:flex; flex-direction:column; align-items:center; gap:12px; padding:12px 8px; box-shadow:var(--shadow); z-index:60; }
.side-btn{ width:52px;height:52px;border-radius:12px; background:#222227;display:grid;place-items:center; font-size:20px;cursor:pointer;user-select:none; transition:transform .12s,background .12s,box-shadow .12s; border:1px solid rgba(255,255,255,0.02);  }
.side-btn:hover{ transform:translateY(-3px); background:#27272b; box-shadow:0 6px 16px rgba(0,0,0,.45) }
.side-badge{ position:absolute;top:6px;right:6px;min-width:18px;height:18px;padding:0 5px; background:#ff4d4d;color:#fff;font-weight:700;font-size:12px;border-radius:999px; display:none;align-items:center;justify-content:center;box-shadow:0 6px 18px rgba(0,0,0,.5); }

/* =================== CHAT (center) =================== */
.chat{ background:var(--chat); display:flex; flex-direction:column; height:100vh; position:relative; min-width:0; width:100%; overflow:hidden; }

/* header (FIXED: min-width:0 + гибкая ширина заголовка) */
.chat-header{
  padding:12px 14px; border-bottom:1px solid var(--divider);
  display:flex; align-items:center; gap:10px; justify-content:space-between;
  background:linear-gradient(90deg,rgba(255,255,255,0.01),rgba(0,0,0,0));
  min-width:0;
}
.header-left{display:flex;align-items:center;gap:12px; flex:1 1 auto; min-width:0;}
/* внутренний контейнер с title/sub — он в разметке без класса */
.header-left > div{display:flex;flex-direction:column; min-width:0; width:100%;}
.icon-btn{ background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--text); width:40px;height:40px;border-radius:10px;display:grid;place-items:center;cursor:pointer; }

.chat-title{
  font-size:17px;font-weight:800;
  overflow:hidden;text-overflow:ellipsis;white-space:nowrap;
  max-width:none; /* FIX: убрали жёсткий предел, даём занять доступное */
}
.chat-sub{
  color:var(--muted);font-size:12px;
  overflow:hidden;text-overflow:ellipsis;white-space:nowrap;
}

@media (min-width:1000px){ 
.bubububebebe {
 display: none;
}
}
/* messages area */
.messages {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 0 14px calc(var(--composer-h) + 12px);
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  flex: 1;
  min-height: 0;
  width: 100%;
}

.messages .bubble:first-child {
  margin-top: 0 !important; /* сбрасываем любой верхний margin у первого */
  transform: none !important; /* убираем translateY для первого */
  opacity: 1 !important;      /* сразу видимый */
}




/* message bubbles — ШИРЕ + разумный минимум (фикс узости) */
.bubble {
  display: block;
  max-width: 400px; /* компактная ширина на ПК */
  min-width: 260px; /* минимальная ширина для небольших экранов */
    margin: 0; /* убираем индивидуальные margin сверху/снизу */
  padding: 8px 12px;
  border-radius: 20px;
  line-height: 1.2; /* чуть выше для читаемости */
  position: relative;
  word-wrap: break-word;
  overflow-wrap: anywhere;
  white-space: pre-wrap;
  transition: transform 0.16s, opacity 0.16s;
  opacity: 0;
  transform: translateY(6px);
  font-size: 17px;
  color: var(--text);
  box-shadow: var(--shadow);
}

/* видимость */
.bubble.show{ opacity:1; transform:none; }

/* alignment */
.from-me{ align-self:flex-end; background:var(--own-accent); color:#eef1f6; border-bottom-right-radius:18px; box-shadow:0 8px 20px rgba(0,0,0,.45); margin:6px 4px 6px 12px; }
.from-other{ align-self:flex-start; background:linear-gradient(135deg,#232327,#2f3136); color:#eef1f6; border-bottom-left-radius:18px; box-shadow:0 8px 18px rgba(0,0,0,.35); margin:6px 12px 6px 4px; }

/* уменьшенные системные уведомления */
.bubble.system{ background:transparent; box-shadow:none; color:var(--muted); padding:6px 10px; border-radius:10px; align-self:center; }

.bubble .meta-name { font-weight:700; font-size:12px; color:var(--text); margin-bottom:6px; }
.bubble .meta-time { position:absolute; right:10px; bottom:8px; font-size:11px; color:var(--muted); pointer-events:none; white-space:nowrap; }

/* meta row (name + time) */
.meta{ font-size:11px;color:var(--muted);margin-bottom:6px;display:flex;align-items:center;gap:8px; }
.meta span:first-child{font-weight:700;color:var(--text);font-size:12px}

/* media внутри сообщения */
.media img{max-width:100%;height:auto;border-radius:10px;display:block;margin-top:8px}
.media audio{width:100%;margin-top:8px}

/* маленькая кнопка "⋮" */
.msg-menu{
  position:absolute;
  top:8px; right:8px;
  background:rgba(0,0,0,.24);
  border:1px solid rgba(255,255,255,0.03);
  backdrop-filter:blur(2px);
  border-radius:8px;
  padding:4px;
  cursor:pointer;
  line-height:1;
  font-size:12px;
  width:28px;height:28px;display:grid;place-items:center;
}

/* ================= ACTIONS: компактная горизонтальная панель ================= */
.actions{
  position:absolute;
  bottom:8px;
  right:8px;
  background:rgba(22,22,24,0.9);
  border:1px solid rgba(255,255,255,0.03);
  border-radius:999px; /* pill */
  padding:4px;
  display:none;
  z-index:30;
  align-items:center;
  gap:6px;
  box-shadow:0 10px 26px rgba(0,0,0,.5);
}
.actions.open{ display:flex; }

.actions button{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  padding:6px 8px;
  font-size:13px;
  line-height:1;
  border-radius:8px;
  border:none;
  background:transparent;
  color:var(--muted);
  cursor:pointer;
  transition:background .12s, color .12s, transform .08s;
}
.actions button:hover{ background:rgba(255,255,255,0.03); color:var(--text); transform:translateY(-1px); }

/* реакции */
.reactions-row{ display:flex; gap:6px; margin-top:8px; flex-wrap:wrap; align-items:center; }
.react-chip{
  display:inline-flex; gap:6px; align-items:center;
  padding:4px 6px; border-radius:999px;
  background:#202026; border:1px solid #2c2c33; font-size:13px; cursor:pointer; user-select:none;
}
.react-chip.me{ outline:2px solid rgba(58,138,255,0.22); }

/* emoji picker */
.picker{
  display:none; margin-top:8px;
  background:#17181c;border:1px solid #2b2b30;border-radius:12px;padding:6px; gap:8px; flex-wrap:wrap;
}
.picker.open{ display:flex; }
.picker span{
  font-size:16px; padding:6px 8px; border-radius:8px; cursor:pointer; background:#1c1d23; border:1px solid #2a2a31;
}

/* =================== COMPOSER (bottom fixed) =================== */
/* убрал жесткую высоту; оставил min-height, добавил safe-area для мобильных */
.composer{
  min-height: var(--composer-h);
  padding:10px 12px calc(10px + env(safe-area-inset-bottom,0px));
  border-top:1px solid var(--divider);
  display:flex; gap:8px; align-items:center;
  background:linear-gradient(180deg, rgba(0,0,0,.04), transparent), #0f1012;
  position:fixed; left:var(--sidebar-w); right:var(--list-min); bottom:0; z-index:12000;
  box-shadow:0 -8px 30px rgba(0,0,0,.55);
}
@media (max-width:1000px){ .composer{ left:0; right:0; } }
.composer .input{
  border-radius:999px;padding:10px 14px;font-size:15px;flex:1;background:#121214;border:1px solid #222224;color:var(--text);outline:none; min-height:40px; max-height:140px; overflow:auto;
}

/* скрепка — теперь строго круглая и не сжимается */
.btnsk {
  flex-shrink: 0; /* запрещаем сжимать */
  width: 46px;
  height: 46px;
  border-radius: 50%;
  background: var(--accent);
  display: grid;
  place-items: center;
  cursor: pointer;
  box-shadow: 0 6px 18px rgba(0,0,0,.25);
  font-size: 18px;
  color: #fff;
  padding: 0;
}

/* primary button & send */
.btn{font-family: 'Futura'; border:none;border-radius:10px;padding:8px 10px;background:var(--accent);color:#fff;cursor:pointer;font-weight:700;box-shadow:0 6px 18px rgba(0,0,0,.25);font-size:13px}
.send{ width:46px;height:46px;border-radius:50%;background:linear-gradient(135deg,#0e0e0e,#1b1b1b);color:#fff;display:grid;place-items:center;padding:0;border:none; box-shadow:0 8px 20px rgba(34, 34, 34, 0.15); }
.send svg{display:block;width:22px;height:22px}

/* =================== RIGHT LIST / ROOMS =================== */
.list{ background:var(--list); border-left:1px solid var(--divider); display:flex; flex-direction:column; overflow:hidden; min-width:var(--list-min); max-width:var(--list-max); }
.list-header{padding:12px;border-bottom:1px solid var(--divider);display:flex;flex-direction:column;gap:8px}
.field{display:flex;gap:8px;align-items:center}
.input{border:none;outline:none;border-radius:10px;padding:8px 10px;background:#202026;color:var(--text);font-size:13px; font-family: 'Futura'; src: url('../fonts/FuturaPT-Demi.ttf') format('truetype');font-style: normal;;}
.rooms{overflow:auto;padding:8px}
.room-item{ display:flex;align-items:center;gap:10px;padding:8px;border-radius:10px;cursor:pointer;user-select:none;transition:background .12s,border-color .12s;border:1px solid transparent;position:relative; }
.room-item:hover{background:#222228;border-color:#2d2d33}
.room-item.active{background:#26262b;border-color:#33333b}
.room-avatar{width:44px;height:44px;border-radius:10px;background:#2b2b33;display:grid;place-items:center;color:#cfd8ff;font-weight:700;font-size:14px;border:1px solid #34343c;overflow:hidden}
.room-avatar img{width:100%;height:100%;object-fit:cover;border-radius:10px}
.room-title{font-weight:700;font-size:13px}
.room-sub{font-size:12px;color:var(--muted)}
.leave-btn{ background:transparent;border:1px solid transparent;color:var(--text);border-radius:6px;padding:4px;cursor:pointer; width:28px;height:28px;display:grid;place-items:center;font-size:13px; }
.room-item .leave-btn:hover{background:#2a2a2f;border-color:#333}

/* Mobile overlay */
.rooms-overlay-backdrop{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.45);z-index:1400;opacity:0;transition:opacity .18s}
.rooms-overlay{display:none;position:fixed;top:0;bottom:0;right:0;width:86%;max-width:360px;background:var(--list);z-index:1500;box-shadow:-8px 0 30px rgba(0,0,0,.5);transform:translateX(100%);transition:transform .22s cubic-bezier(.2,.9,.2,1);overflow:auto}
.rooms-overlay-backdrop.show{display:block;opacity:1}
.rooms-overlay.open{display:block;transform:translateX(0)}

/* =================== RESPONSIVE tweaks =================== */
@media (max-width:1200px){ :root{ --list-max:300px; } }
/* На мобильных — почти во всю ширину, без большого минимума */
@media (max-width:1000px){
  body{ grid-template-columns:1fr; }
  .sidebar{ display:none; }
  .list{ display:none; }
  .chat-header .chat-title{ max-width:none; }
  .bubble{ max-width:76%; min-width:72%; } /* FIX mobile: широкие пузырьки */
  .composer{ left:0; right:0; }
}

/* focus/accessibility */
button:focus, .input:focus{ outline:none; box-shadow:0 0 0 3px rgba(58,138,255,0.06); border-color:rgba(58,138,255,0.08) }
img{max-width:100%;height:auto}
a{color:inherit}

.header-logo {
  display: none; /* по умолчанию скрыто */
  height: 40px; /* подстрой под размер шапки */
}

/* На больших экранах >1000px */
@media (min-width: 1000px) {
  #toggleRoomsBtn,
  .chat-text {
    display: none; /* скрываем меню и текст */
  }

  .header-logo {
    display: block; /* показываем лого */
  }
}

/* немного уменьшил внутренние отступы composer */
.composer {
  padding: 8px;
}

/* контейнер для input + reply-bar */
.chat-input-container {
  position: relative; /* чтобы reply-bar позиционировался относительно контейнера */
  display: flex;
  align-items: center;
  gap: 6px;
  width: 100%;
}

/* сам input внутри контейнера */
.chat-input-container .input {
  flex: 1;
  border-radius: 999px;
  padding: 10px 14px;
  font-size: 15px;
  background: #121214;
  border: 1px solid #222224;
  color: var(--text);
  outline: none;
  min-height: 40px;
  max-height: 140px;
  overflow: auto;
}

/* reply-bar — панель над инпутом */
.reply-bar {
  position: absolute;
  bottom: 100%; /* ставим над input */
  left: 0;
  width: 100%;
  max-height: 48px;
  background: #1d1d20;
  border-left: 4px solid var(--accent);
  border-radius: 8px 8px 0 0;
  padding: 6px 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 14px;
  font-family: 'Futura', sans-serif;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  z-index: 20;
}

.reply-bar.hidden {
  display: none;
}

.reply-bar span {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* compact cancel button */
.reply-bar button {
  background: none;
  border: none;
  color: var(--muted);
  font-size: 18px;
  cursor: pointer;
}

.message {
  position: relative;
  transition: transform 0.25s ease;
}

/* Стиль при свайпе */
.message.swipe-active {
  background: rgba(58, 58, 58, 0.3);
}

/* Уменьшаем зазор между reply и текстом */
.message .reply {
  margin-bottom: 2px; /* Было больше, теперь почти нет зазора */
}

.message .message-text {
  margin-top: 0; /* убираем лишний отступ */
}


.message-footer {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-top: 4px;
}

.read-status {
  display: flex;
  align-items: center;
}

.read-dot, .delivered-dot {
  font-size: 12px;
  opacity: 0.7;
}

.read-dot {
  color: #4CAF50;
}

.delivered-dot {
  color: #9E9E9E;
}

.bubble.from-me .read-status {
  margin-left: auto;
}

/* ================= Compact reply preview overrides (концентрированная панель ответа) ================= */

/* чуть меньше зазор между сообщениями */
.messages { gap: 6px; }

/* чуть компактнее сам пузырёк */
/* компактнее пузырьки */
.bubble{ padding: 8px 12px; line-height: 1.25; }
.bubble .message-text{ margin: 0; }



/* компактное превью ответа */
.reply-preview {
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 2px;
  padding: 4px 6px;
  margin: 0 0 6px 0;
  border-left: 3px solid var(--accent);
  border-radius: 6px;
  font-size: 12.5px;
  line-height: 0ю;
  max-height: 40px;
  overflow: hidden;
  background: rgba(255,255,255,0.02);
}

/* автор в превью — компактный и визуально отделён */
.reply-preview .reply-author {
  font-weight: 600;
  font-size: 12.5px;
  color: var(--accent);
  margin: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* сниппет — одна строчка с троеточием */
.reply-preview .reply-snippet {
  font-size: 12.5px;
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin: 0;
}

.bubble {
  display: flex;
  flex-direction: column;
}

.bubble .reply-preview + .message-text {
  margin-top: 0;       /* убираем margin у текста */
  padding-top: 0;      /* если есть padding сверху */
}



/* чуть плотнее вертикальные отступы у пузырьков */


/* небольшая подсветка при скролле/фокусе */
.ping {
  box-shadow: 0 0 0 3px rgba(58,138,255,0.06) inset;
  transition: box-shadow .25s ease;
}

.bubble .reply-preview {
  margin: 0 !important;
  padding: 2px 4px;
}

.bubble .message-text {
  margin: 0 !important;
  padding: 0;
  line-height: 1.2;
}
